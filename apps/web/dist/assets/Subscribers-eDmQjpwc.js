import{u as y,d as j,r as u,b as l,j as e}from"./index-CDXMD3eC.js";import{u as N}from"./useQuery-DAJvBtLK.js";import{u as n}from"./useMutation-7BwsYuZ6.js";function S(){const{currentWorkspace:a}=y(),i=j(),[m,d]=u.useState(!1),[s,r]=u.useState({username:"",name:"",email:"",whatsapp:"",address:""}),{data:c,isLoading:b}=N({queryKey:["subscribers",a==null?void 0:a.id],queryFn:()=>l.getSubscribers(a.id),enabled:!!a}),x=n({mutationFn:t=>l.createSubscriber(a.id,t),onSuccess:()=>{i.invalidateQueries({queryKey:["subscribers"]}),d(!1),r({username:"",name:"",email:"",whatsapp:"",address:""})}}),g=n({mutationFn:l.suspendSubscriber,onSuccess:()=>i.invalidateQueries({queryKey:["subscribers"]})}),h=n({mutationFn:l.activateSubscriber,onSuccess:()=>i.invalidateQueries({queryKey:["subscribers"]})}),p=n({mutationFn:l.deleteSubscriber,onSuccess:()=>i.invalidateQueries({queryKey:["subscribers"]})}),o=(c==null?void 0:c.subscribers)||[];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Subscribers"}),e.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors",children:"+ Add Subscriber"})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-full max-w-md border border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Add Subscriber"}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),x.mutate(s)},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Username *"}),e.jsx("input",{type:"text",value:s.username,onChange:t=>r({...s,username:t.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:t=>r({...s,name:t.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:t=>r({...s,email:t.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"WhatsApp"}),e.jsx("input",{type:"text",value:s.whatsapp,onChange:t=>r({...s,whatsapp:t.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"+62..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Address"}),e.jsx("textarea",{value:s.address,onChange:t=>r({...s,address:t.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",rows:2})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x.isPending,className:"flex-1 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white disabled:opacity-50",children:x.isPending?"Creating...":"Create"})]})]})]})}),e.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-750",children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Username"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Plan"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:b?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"Loading..."})}):o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"No subscribers yet"})}):o.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-white font-medium",children:t.username}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.name||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.plan_name||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.status==="active"?"bg-green-500/20 text-green-400":t.status==="suspended"?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[t.status==="active"?e.jsx("button",{onClick:()=>g.mutate(t.id),className:"px-2 py-1 text-xs bg-yellow-600 hover:bg-yellow-700 rounded text-white",children:"Suspend"}):e.jsx("button",{onClick:()=>h.mutate(t.id),className:"px-2 py-1 text-xs bg-green-600 hover:bg-green-700 rounded text-white",children:"Activate"}),e.jsx("button",{onClick:()=>{confirm("Delete subscriber?")&&p.mutate(t.id)},className:"px-2 py-1 text-xs bg-red-600 hover:bg-red-700 rounded text-white",children:"Delete"})]})})]},t.id))})]})})]})}export{S as default};
